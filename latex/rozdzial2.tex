\chapter{Projekt systemu}
\thispagestyle{chapterBeginStyle}
W tym rozdziale przedstawiono scenariusze oraz przypadki uzycia systemu, na koncu znajduje sie diagram przedstawiajacy zachowanie systemu w okreslonych sytuacjach. Omowiono i przedstawiono w postaci pseudokodu algorytmy zastosowane w systemie. 

\section{Założenia i ograniczenia}
wyłącznie foldery i pliki tekstowe, bez linków itd, podstawowe operacje z czego to wynika podział danych

{\color{dgray}
Architektura systemu \ldots jest wielowarstwowa i rozproszona, przy czym \ldots. Podsystem  \ldots jest systemem zbiorczym dla danych \ldots wysyłanych do serwera \ldots. 

Taka architektura jest zgodna z wzorcem projektowym MVC\footnote{Należy odnieść się do wykorzystywanych wzorców projektowych} (ang.  Model-View-Controller). Przetwarzanie danych odbywa się \ldots.
} 

\section{Przypadki użycia i scenariusze}
\subsection{Montowanie systemu plików}
\begin{table}[h!]
        \centering
        \begin{tabular}{ |l|p{10cm}| }
                \hline
            S01 & Montowanie systemu plików \\ \hline
            Aktor & Użytkownik \\ \hline
            Warunki wsępne & Aktor przygotował konfigurację systemu \\ \hline
            & \\ Przebieg wydarzeń & \textbullet Aktor montuje system, podając plik konfiguracyjny \newline \newline 
            \textbullet System odczytuje konfigurację \newline \newline 
            \textbullet System dostosowuje parametry i montuje system plików \\
            & \\ \hline
            Alternatywny przebieg wydarzeń & \textbullet Aktor konfiguruje system przez argumenty wywołania \\ \hline
            Sytuacje wyjątkowe & \textbullet Aktor podał niepoprawną konfigurację \newline \newline
            \textbullet Katalogi podane przez aktora nie istnieją lub są niepoprawne \\ \hline
            Warunki końcowe & System plików jest poprawnie zamontowany pod podanym katalogiem \\ \hline
        \end{tabular}
        \caption{Montowanie systemu plików}
\end{table}
\newpage

\subsection{Odczyt pliku}

\begin{table}[h!]
        \centering
        \begin{tabular}{ |l|p{10cm}| }
                \hline
            S02.1 & Odczyt pliku w standardowej replice\\ \hline
            Aktor & Użytkownik \\ \hline
            Warunki wstępne & System plików jest zamontowany, tylko jedna aktywna replika\\ \hline
            Przebieg wydarzeń & 
            1. Aktor podaje plik do odczytu \newline \newline
            2. System otwiera plik, jesli nie ma do niego uchwytu  \newline \newline
            3. System odczytuje zadana zawartosc pliku \newline \newline
            4. System odczytuje nadmiarowe bity \newline \newline
            5. Na podstawie posiadanych informacji system ocenia integralnosc odczytanych danych \newline \newline
            6. System informuje aktora o uszkodzonej zawartosci \newline \newline
            7. Aktor dostaje odczytane dane \\ \hline
            Alternatywny przebieg wydarzeń & 
            Brak \\ \hline
            Sytuacje wyjątkowe & \textbullet Blad podczas otwierania pliku\newline \newline
            \textbullet Błąd oczytu \newline \newline
            \textbullet Dysk z repliką został odmontowany lub uszkodzony \\ \hline
            Warunki końcowe & System zwrócił aktorowi odczytane dane \\ \hline
        \end{tabular}
        \caption{Odczyt pliku w standardowej replice}
\end{table}

\begin{table}[h!]
        \centering
        \begin{tabular}{ |l|p{10cm}| }
                \hline
            S02.2 & Odczyt pliku w replice korekcyjnej\\ \hline
            Aktor & Użytkownik \\ \hline
            Warunki wsępne & System plików jest zamontowany, replika wspiera korekcję błędów \\ \hline
            Przebieg wydarzeń & 
            1. Aktor podaje plik do odczytu \newline \newline
            2. System otwiera plik, jesli nie ma do niego uchwytu  \newline \newline
            3. System odczytuje zadana zawartosc pliku \newline \newline
            4. System odczytuje nadmiarowe bity \newline \newline
            5. Na podstawie posiadanych informacji system ocenia integralnosc odczytanych danych \newline \newline
            6. System podejmuje probe naprawy znalezionych bledow \newline \newline
            6. System informuje aktora o nadal uszkodzonej zawartosci \newline \newline
            7. Aktor dostaje odczytane dane \\ \hline
            Alternatywny przebieg wydarzeń & 
            5. Nie znaleziono bledow\newline \newline
            6. Aktor dostaje odczytane dane\\ \hline
            Sytuacje wyjątkowe & \textbullet Blad podczas otwierania pliku\newline \newline
            \textbullet Nieudany odczyt pliku \newline \newline
            \textbullet Dysk z repliką został odmontowany lub uszkodzony \\ \hline
            Warunki końcowe & System zwrócił aktorowi odczytane dane \\ \hline
        \end{tabular}
        \caption{Odczyt pliku w replice korekcyjnej}
\end{table}

\newpage
\begin{table}[h!]
        \centering
        \begin{tabular}{ |l|p{10cm}| }
                \hline
            S02.4 & Odczyt pliku przy wykorzystaniu wielu replik\\ \hline
            Aktor & Użytkownik \\ \hline
            Warunki wstępne & System plików jest zamontowany, wiele replik aktywnych \\ \hline
            Przebieg wydarzeń & 
            1. Aktor podaje plik do odczytu \newline \newline 
            2. System dokonuje wyboru repliki\newline \newline
            3. System przekazuje replice plik do odczytu\newline \newline
            4. System naprawia bledy przenoszac dane z kolejnej najlepszej repliki \newline \newline
            5. Aktor dostaje odczytane dane \\ \hline
            Alternatywny przebieg wydarzeń & 
            4. Dane w replice nie zostały naprawione \newline \newline
            5. System wyłącza replikę \newline \newline \newline \newline
            4. Nie ma wiecej replik \newline \newline
            5. System informuje aktora o bledach \newline \newline
            6. Aktor dostaje odczytane dane\\ \hline
            Sytuacje wyjątkowe & \textbullet Blad podczas otwierania pliku\newline \newline
            \textbullet Błąd oczytu \newline \newline
            \textbullet Replika jest jedyną działającą \\ \hline
            Warunki końcowe & System zwrócił aktorowi odczytane dane i replika została naprawiona lub wyłączona \\ \hline
        \end{tabular}
        \caption{Odczyt pliku przy wykorzystaniu wielu replik}
\end{table}
Tu moglby sie wykres przydac do tego tam wyzej
\begin{table}[h!]
        \centering
        \begin{tabular}{ |l|p{10cm}| }
                \hline
            S02.5 & Odczyt brakujacego pliku w replice\\ \hline
            Aktor & Użytkownik \\ \hline
            Warunki wstępne & System plików jest zamontowany \\ \hline
            Przebieg wydarzeń & 
            1. Aktor podaje plik do odczytu \newline \newline 
            2. System wybiera najlepsza replike\newline \newline
            3. System wykrywa brak pliku w replice\newline \newline
            4. System sprawdza obecnosc nieuszkodzonego pliku w pozostalych replikach \newline \newline
            6. Brakujace dane zostaja zsynchronizowane miedzy replikami\\ \hline
            Alternatywny przebieg wydarzeń & 
            \textbullet Brak innych replik \newline \newline
            \textbullet Brak pliku we wszystkich replikach \newline \newline
            \textbullet Znalezione kopie pliku sa uszkodzone, wystepuje konflikt \\ \hline
            Sytuacje wyjątkowe &
            \textbullet Blad podczas otwierania pliku \newline \newline
            \textbullet Błąd odczytu \\ \hline
            Warunki końcowe & System zwrócił aktorowi odczytane dane i dane zostaly zsynchronizowane lub aktor zostal poinformowany o braku pliku\\ \hline
        \end{tabular}
        \caption{Odczyt brakujacego pliku w replice}
\end{table}

\newpage


\subsection{Zapis pliku}
\begin{table}[h!]
        \centering
        \begin{tabular}{ |l|p{10cm}| }
                \hline
            S03.1 & Zapis pliku przy wykorzystaniu pojedynczej repliki korekcyjnej \\ \hline
            Aktor & Użytkownik \\ \hline
            Warunki wstępne & System plików jest zamontowany, replika wspiera korekcję błędów \\ \hline
            Przebieg wydarzeń & 
            1. Aktor podaje dane do zapisu \newline \newline 
            2. System dopisuje dodatkowe informacje do korekty \newline \newline 
            3. System zapisuje do repliki \\ \hline
            Alternatywny przebieg wydarzeń &
            4. System nie może dopisać dodatkowych informacji  \newline \newline
            5. System zwraca błąd zapisu \\ \hline
            Sytuacje wyjątkowe & 
            \textbullet Nieudany zapis pliku \newline \newline
            \textbullet Dysk z repliką został odmontowany lub uszkodzony \newline \newline
            \textbullet Brak miejsca na replice \\ \hline
            Warunki końcowe & System zapisał dane podane przez aktora oraz informacje do korekcji \\ \hline
        \end{tabular}
        \caption{Zapis pliku przy wykorzystaniu pojedynczej repliki korekcyjnej} 
\end{table}

\begin{table}[h!]
        \centering
        \begin{tabular}{ |l|p{10cm}| }
                \hline
                S03.2 & Zapis pliku przy wykorzystaniu pojedynczej repliki standardowej\\ \hline
            Aktor & Użytkownik \\ \hline
            Warunki wstępne & System plików jest zamontowany, replika nie wspiera korekcji błędów \\ \hline
            Przebieg wydarzeń & 
            1. Aktor podaje dane do zapisu \newline \newline
            2. System dopisuje dodatkowe informacje do detekcji bledow \newline \newline
            2. System zapisuje do repliki \\ \hline
            Alternatywny przebieg wydarzeń &
            3. System nie może zapisać do repliki  \newline \newline
            4. System zwraca błąd zapisu \\ \hline
            Sytuacje wyjątkowe & 
            \textbullet Nieudany zapis pliku \newline \newline
            \textbullet Dysk z repliką został odmontowany lub uszkodzony \newline \newline
            \textbullet Brak miejsca na replice \\ \hline
            Warunki końcowe & System zapisał dane podane przez aktora \\ \hline
        \end{tabular}
        \caption{Zapis pliku przy wykorzystaniu pojedynczej repliki standardowej}
\end{table}
\newpage

\begin{table}[h!]
        \centering
        \begin{tabular}{ |l|p{10cm}| }
                \hline
            S03.3 & Zapis pliku przy wykorzystaniu wielu replik\\ \hline
            Aktor & Użytkownik \\ \hline
            Warunki wstępne & System plików jest zamontowany, wiele replik \\ \hline
            Przebieg wydarzeń & 
            1. Aktor podaje dane do zapisu \newline \newline 
            2. System zapisuje dane do każdej repliki \newline \newline 
            3. Każdy błąd zapisu wyłącza daną replikę\\ \hline
            Alternatywny przebieg wydarzeń &
            Brak \\ \hline
            Sytuacje wyjątkowe & 
            \textbullet Nieudany zapis pliku do każdej repliki\newline \newline
            \textbullet Wszystkie repliki zostały wyłączone \\ \hline
            Warunki końcowe & System zapisał dane podane przez aktora i są działające repliki\\ \hline
        \end{tabular}
        \caption{Zapis pliku przy wykorzystaniu wielu replik} 
\end{table}

\subsection {Niezorganizowane}
\begin{table}[h!]
        \centering
        \begin{tabular}{ |l|p{10cm}| }
                \hline
            S04.1 & Wybor najlepszej repliki\\ \hline
            Aktor & Użytkownik \\ \hline
            Warunki wstępne & System plików jest zamontowany, przynajmniej jedna replika\\ \hline
            Przebieg wydarzeń & 
            1. System sprawdza czy sa aktywne repliki \newline \newline 
            2. System wybiera najlepsza replike z aktywnych \\ \hline
            Alternatywny przebieg wydarzeń &
            Brak \\ \hline
            Sytuacje wyjątkowe & 
            \textbullet Wszystkie repliki zostały wyłączone \\ \hline
            Warunki końcowe & System wybral replike i wykonuje operacje aktora\\ \hline
        \end{tabular}
        \caption{Wybor najlepszej repliki} 
\end{table}



\newpage





\section{Diagramy}

\section{Opis algorytmów}

W tej sekcji należy wymienić i przedyskutować algorytmy wykorzystywane w systemie. Algorytmy należy przedstawić w pseudokodzie (wykorzystać pakiet \texttt{algorithm2e}). Omówienia poszczególnych kroków algorytmów powinny zawierać odwołania do odpowiednich linii pseudokodu. Dla zaproponowanych autorskich algorytmów należy przeprowadzić analizę ich złożoności czasowej i pamięciowej. 

~\ref{alg:mine}.

{\small
\begin{pseudokod}[H]
%\SetAlTitleFnt{small}
\SetArgSty{normalfont}
\SetKwFunction{Process}{Process}
\SetKwFunction{Calculate}{Calculate}
\KwIn{Zbiór bąbli $B$}
\KwOut{Wyporność $W$}
\ForEach{$b \in B$}{
\Process{$b$}\;
\For{$i \leftarrow 1$ \KwTo $|B|$}{
\If{\Calculate{EW($i$,$b$)} $\le$ 0}{
$b \leftarrow 2*b$\;
}
}
}
\While{$B \neq \emptyset$}{
\For{$j \leftarrow 1$ \KwTo $|B|$}{
\If{\Calculate{FT($j$,$\hat{b}$)} $\le 0$}{
$w \leftarrow 2*\hat{b}$\;
$W \leftarrow W \cup \{w\}$\;
$B \leftarrow B \setminus \{b\}$\;
}
}
}
\caption{Wybor najlepszej repliki}\label{alg:mine}
\end{pseudokod}
}

{\small
\begin{pseudokod}[H]
%\SetAlTitleFnt{small}
\caption{Odczyt danych z pliku}\label{alg:mine}
\end{pseudokod}
}

{\small
\begin{pseudokod}[H]
%\SetAlTitleFnt{small}
\caption{Zapis danych do pliku}\label{alg:mine}
\end{pseudokod}
}

{\small
\begin{pseudokod}[H]
%\SetAlTitleFnt{small}
\caption{Tworzenie nowego pliku}\label{alg:mine}
\end{pseudokod}
}

{\small
\begin{pseudokod}[H]
%\SetAlTitleFnt{small}
\caption{Usuwanie pliku}\label{alg:mine}
\end{pseudokod}
}

{\small
\begin{pseudokod}[H]
%\SetAlTitleFnt{small}
\caption{Kodowanie Huffmana}\label{alg:mine}
\end{pseudokod}
}

{\small
\begin{pseudokod}[H]
%\SetAlTitleFnt{small}
\caption{Obliczanie parzystosci dla danych}\label{alg:mine}
\end{pseudokod}
}

{\small
\begin{pseudokod}[H]
%\SetAlTitleFnt{small}
\caption{Odzyskiwanie pliku}\label{alg:mine}
\end{pseudokod}
}

{\small
\begin{pseudokod}[H]
%\SetAlTitleFnt{small}
\caption{Synchronizacja replik}\label{alg:mine}
\end{pseudokod}
}



