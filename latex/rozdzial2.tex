\chapter{Projekt systemu}
\thispagestyle{chapterBeginStyle}
Dla uproszczenia tylko pliki tekstowe, wiec raczej operacje na bajtach
{\color{dgray}
W tym rozdziale przedstawiono szczegółowy projekt systemy w notacji UML uwzględniający wymagania funkcjonalne opisane w rozdziale~\ref{rozdzial1}. Do opisu relacji pomiędzy składowymi systemu wykorzystano diagramy \ldots.
Przedstawiono w pseudokodzie i omówiono algorytmy generowania \ldots.
}


\section{Grupy użytkowników i założenia}

{\color{dgray}
Architektura systemu \ldots jest wielowarstwowa i rozproszona, przy czym \ldots. Podsystem  \ldots jest systemem zbiorczym dla danych \ldots wysyłanych do serwera \ldots. 

Taka architektura jest zgodna z wzorcem projektowym MVC\footnote{Należy odnieść się do wykorzystywanych wzorców projektowych} (ang.  Model-View-Controller). Przetwarzanie danych odbywa się \ldots.
} 

\section{Przypadki użycia i scenariusze}
\subsection{Montowanie systemu plików}
\begin{table}[h!]
        \centering
        \begin{tabular}{ |l|p{10cm}| }
                \hline
            S01 & Montowanie systemu plików \\ \hline
            Aktor & Użytkownik \\ \hline
            Warunki wsępne & Aktor przygotował konfigurację systemu \\ \hline
            Przebieg wydarzeń & \textbullet Aktor montuje system, podając plik konfiguracyjny \newline \newline 
            \textbullet System odczytuje konfigurację \newline \newline 
            \textbullet System dostosowuje parametry i montuje system plików \\ \hline
            Alternatywny przebieg wydarzeń & \textbullet Aktor konfiguruje system przez argumenty wywołania \\ \hline
            Sytuacje wyjątkowe & \textbullet Aktor podał niepoprawną konfigurację \newline \newline
            \textbullet Katalogi podane przez aktora nie istnieją lub są niepoprawne \\ \hline
            Warunki końcowe & System plików jest poprawnie zamontowany pod podanym katalogiem \\ \hline
        \end{tabular}
        \caption{Montowanie systemu plików}
\end{table}
\newpage

\subsection{Odczyt pliku}
\begin{table}[h!]
        \centering
        \begin{tabular}{ |l|p{10cm}| }
                \hline
            S02.1 & Odczyt pliku przy wykorzystaniu pojedynczej repliki korekcyjnej \\ \hline
            Aktor & Użytkownik \\ \hline
            Warunki wsępne & System plików jest zamontowany, replika wspiera korekcję błędów \\ \hline
            Przebieg wydarzeń & 
            1. Aktor podaje plik do odczytu \newline \newline 
            2. System sprawdza spójność pliku w replice \newline \newline 
            3. System dokonuje korekty istniejących uszkodzeń pliku przed odczytem danych \newline \newline
            4. Aktor dostaje odczytane dane \\ \hline
            Alternatywny przebieg wydarzeń & 
            3. System nie może dokonać korekty błędów  \newline \newline
            4. Aktor zostaje poinformowany o błędzie przez \newline \newline
            5. Aktor dostaje odczytane dane\\ \hline
            Sytuacje wyjątkowe & \textbullet Dany plik nie istnieje w replice  \newline \newline
            \textbullet Nieudany odczyt pliku \newline \newline
            \textbullet Dysk z repliką został odmontowany lub uszkodzony \\ \hline
            Warunki końcowe & System zwrócił aktorowi odczytane dane \\ \hline
        \end{tabular}
        \caption{Odczyt pliku przy wykorzystaniu pojedynczej repliki korekcyjnej}
\end{table}

\begin{table}[h!]
        \centering
        \begin{tabular}{ |l|p{10cm}| }
                \hline
            S02.2 & Odczyt pliku przy wykorzystaniu pojedynczej repliki standardowej  \\ \hline
            Aktor & Użytkownik \\ \hline
            Warunki wsępne & System plików jest zamontowany, replika nie wspiera korekty błędów \\ \hline
            Przebieg wydarzeń & 
            1. Aktor podaje plik do odczytu \newline \newline 
            2. System sprawdza spójność pliku w replice \newline \newline
            3. System informuje o znalezionych błędach \newline \newline
            4. Aktor dostaje odczytane dane \\ \hline
            Alternatywny przebieg wydarzeń & 
            Brak\\ \hline
            Sytuacje wyjątkowe & \textbullet Dany plik nie istnieje w replice  \newline \newline
            \textbullet Błąd oczytu \newline \newline
            \textbullet Dysk z repliką został odmontowany lub uszkodzony \\ \hline
            Warunki końcowe & System zwrócił aktorowi odczytane dane \\ \hline
        \end{tabular}
        \caption{Odczyt pliku przy wykorzystaniu pojedynczej standardowej repliki}
\end{table}

\newpage
\begin{table}[h!]
        \centering
        \begin{tabular}{ |l|p{10cm}| }
                \hline
            S02.4 & Odczyt pliku przy wykorzystaniu wielu replik\\ \hline
            Aktor & Użytkownik \\ \hline
            Warunki wsępne & System plików jest zamontowany, replika nie wspiera korekty błędów \\ \hline
            Przebieg wydarzeń & 
            1. Aktor podaje plik do odczytu \newline \newline 
            2. System odczytuje plik z najlepszej repliki\newline \newline
            3. System naprawia uszkodzenia odczytując dane z innych replik \newline \newline
            4. Aktor dostaje odczytane dane \\ \hline
            Alternatywny przebieg wydarzeń & 
            4. Dane w replice nie zostały naprawione \newline \newline
            5. System wyłącza replikę \\ \hline
            Sytuacje wyjątkowe & \textbullet Dany plik nie istnieje w replice  \newline \newline
            \textbullet Błąd oczytu \newline \newline
            \textbullet Replika jest jedyną działającą \\ \hline
            Warunki końcowe & System zwrócił aktorowi odczytane dane i replika została naprawiona lub wyłączona \\ \hline
        \end{tabular}
        \caption{Odczyt pliku przy wykorzystaniu wielu replik}
\end{table}

\newpage


\subsection{Zapis pliku}
\begin{table}[h!]
        \centering
        \begin{tabular}{ |l|p{10cm}| }
                \hline
            S03.1 & Zapis pliku przy wykorzystaniu pojedynczej repliki korekcyjnej \\ \hline
            Aktor & Użytkownik \\ \hline
            Warunki wsępne & System plików jest zamontowany, replika wspiera korekcję błędów \\ \hline
            Przebieg wydarzeń & 
            1. Aktor podaje dane do zapisu \newline \newline 
            2. System dopisuje dodatkowe informacje do korekcji \newline \newline 
            3. System zapisuje do repliki \\ \hline
            Alternatywny przebieg wydarzeń &
            4. System nie może dopisać dodatkowych informacji  \newline \newline
            5. System zwraca błąd zapisu \\ \hline
            Sytuacje wyjątkowe & 
            \textbullet Nieudany zapis pliku \newline \newline
            \textbullet Dysk z repliką został odmontowany lub uszkodzony \newline \newline
            \textbullet Brak miejsca na replice \\ \hline
            Warunki końcowe & System zapisał dane podane przez aktora oraz informacje do korekcji \\ \hline
        \end{tabular}
        \caption{Zapis pliku przy wykorzystaniu pojedynczej repliki korekcyjnej} 
\end{table}

\begin{table}[h!]
        \centering
        \begin{tabular}{ |l|p{10cm}| }
                \hline
                S03.2 & Zapis pliku przy wykorzystaniu pojedynczej repliki standardowej\\ \hline
            Aktor & Użytkownik \\ \hline
            Warunki wsępne & System plików jest zamontowany, replika nie wspiera korekcji błędów \\ \hline
            Przebieg wydarzeń & 
            1. Aktor podaje dane do zapisu \newline \newline 
            2. System zapisuje do repliki \\ \hline
            Alternatywny przebieg wydarzeń &
            3. System nie może zapisać do repliki  \newline \newline
            4. System zwraca błąd zapisu \\ \hline
            Sytuacje wyjątkowe & 
            \textbullet Nieudany zapis pliku \newline \newline
            \textbullet Dysk z repliką został odmontowany lub uszkodzony \newline \newline
            \textbullet Brak miejsca na replice \\ \hline
            Warunki końcowe & System zapisał dane podane przez aktora \\ \hline
        \end{tabular}
        \caption{Zapis pliku przy wykorzystaniu pojedynczej repliki standardowej}
\end{table}
\newpage

\begin{table}[h!]
        \centering
        \begin{tabular}{ |l|p{10cm}| }
                \hline
            S03.3 & Zapis pliku przy wykorzystaniu wielu replik\\ \hline
            Aktor & Użytkownik \\ \hline
            Warunki wsępne & System plików jest zamontowany, wiele replik \\ \hline
            Przebieg wydarzeń & 
            1. Aktor podaje dane do zapisu \newline \newline 
            2. System zapisuje dane do każdej repliki \newline \newline 
            3. Każdy błąd zapisu wyłącza daną replikę\\ \hline
            Alternatywny przebieg wydarzeń &
            Brak \\ \hline
            Sytuacje wyjątkowe & 
            \textbullet Nieudany zapis pliku do każdej repliki\newline \newline
            \textbullet Wszystkie repliki zostały wyłączone \newline \newline
            \textbullet \\ \hline
            Warunki końcowe & System zapisał dane podane przez aktora i są działające repliki\\ \hline
        \end{tabular}
        \caption{Zapis pliku przy wykorzystaniu wielu replik} 
\end{table}
\newpage




\section{Diagramy klas}

W tej sekcji należy przedstawić diagramy klas dla odpowiednich elementów systemu zidentyfikowane na podstawie wcześniejszych rozważań 



\section{Diagramy sekwencji}

W tej sekcji należy przedstawić diagramy sekwencji dla obiektów systemu zidentyfikowanych na podstawie wcześniejszych rozważań. Należy wykorzystać nazewnictwo wprowadzone w poprzednich rozdziałach, w szczególności odpowiadające definicjom wprowadzonych klas.

\section{Diagramy stanów}

W tej sekcji należy przedstawić diagramy stanów w których może znaleźć się system. Diagramy te są szczególnie istotne przy projektowaniu systemów czasu rzeczywistego. 

\section{Projekt bazy danych}

W tej sekcji należy przedstawić projekt bazy danych. Należy omówić wycinek rzeczywistości i odpowiadające mu zidentyfikowane elementy systemu, których wartości będą podlegać utrwalaniu. Należy przedyskutować wybór typów danych dla atrybutów poszczególnych obiektów. Należy uzasadnić wybór platformy DBMS. Dla relacyjnych baz danych należy przedyskutować jej normalizację.

\section{Opis protokołów}

W tej sekcji należy omówić protokoły wykorzystywane przez komponenty systemu. Omówić formaty komunikatów i zilustrować je przykładami. 

\section{Opis algorytmów}

W tej sekcji należy wymienić i przedyskutować algorytmy wykorzystywane w systemie. Algorytmy należy przedstawić w pseudokodzie (wykorzystać pakiet \texttt{algorithm2e}). Omówienia poszczególnych kroków algorytmów powinny zawierać odwołania do odpowiednich linii pseudokodu. Dla zaproponowanych autorskich algorytmów należy przeprowadzić analizę ich złożoności czasowej i pamięciowej. 

{\color{dgray}
Algorytm bąblowania jest przedstawiony w Pseudokodzie~\ref{alg:mine}.
}

{\small
\begin{pseudokod}[H]
%\SetAlTitleFnt{small}
\SetArgSty{normalfont}
\SetKwFunction{Process}{Process}
\SetKwFunction{Calculate}{Calculate}
\KwIn{Zbiór bąbli $B$}
\KwOut{Wyporność $W$}
\ForEach{$b \in B$}{
\Process{$b$}\;
\For{$i \leftarrow 1$ \KwTo $|B|$}{
\If{\Calculate{EW($i$,$b$)} $\le$ 0}{
$b \leftarrow 2*b$\;
}
}
}
\While{$B \neq \emptyset$}{
\For{$j \leftarrow 1$ \KwTo $|B|$}{
\If{\Calculate{FT($j$,$\hat{b}$)} $\le 0$}{
$w \leftarrow 2*\hat{b}$\;
$W \leftarrow W \cup \{w\}$\;
$B \leftarrow B \setminus \{b\}$\;
}
}
}
\caption{Wyporność przez bąblowanie}\label{alg:mine}
\end{pseudokod}
}

